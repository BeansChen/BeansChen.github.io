(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{383:function(t,n,s){"use strict";s.r(n);var a=s(14),e=Object(a.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动 ")]),t._v("\nstart nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止")]),t._v("\nnginx.exe "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" stop\nnginx.exe "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" quit\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启")]),t._v("\nnginx.exe "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" reload\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日志")]),t._v("\nnginx.exe "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" reopen\n")])])]),n("h2",{attrs:{id:"配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进程数量")]),t._v("\nworker_processes 1;\n\nevents "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大连接数量")]),t._v("\n  worker_connections 1024;\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nhttp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  include mime.types;\n  default_type application/octet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("stream;\n  sendfile on;\n  keepalive_timeout 65;\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 演示如何强制http跳转https")]),t._v("\n  server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen 80;\n    server_name test.com;\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http强制跳转到https")]),t._v("\n    rewrite ^(."),n("span",{pre:!0,attrs:{class:"token important"}},[t._v("*)$")]),t._v(" https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//$server_name$1 permanent;\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 演示如何配置微信支付的校验文件")]),t._v("\n  server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen 80;\n    server_name localhost;\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认根路径")]),t._v("\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      root index.html;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 微信支付校验文件，可以直接配置访问名称")]),t._v("\n    location ^~/MP_verify_2g3uEjrB5B2LIbNl.txt "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      alias /home/MP_verify_2g3uEjrB5B2LIbNl.txt;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 微信支付校验文件，也可以通过正则配置")]),t._v("\n    location ~^/MP_verify_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zA"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Z0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token important"}},[t._v("*\\.(txt)$")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      root /home/;\n      rewrite ^/home/(.txt)$ /home/$1 last;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 演示root和alias两种配置静态资源的区别")]),t._v("\n  server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen 80;\n    server_name localhost;\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用root方式，location中的路径会拼加到root的地址后面")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://localhost:8080/files/index.jpg    实际访问为：/home/files/index.jpg")]),t._v("\n    location ~^/files/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      root /home/;\n      index index.html index.htm;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用alias方式，location中的路径不会拼加到alias的地址后面")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这请求路径为：http://localhost:8080/files/index.jpg    实际访问为：/home/index.jpg")]),t._v("\n    location ~^/files/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      alias /home/;\n      index index.html index.htm;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 演示请求后台接口代理配置")]),t._v("\n  server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen 8080;\n    server_name localhost;\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#################### 第一种场景（代理地址不加斜杠） ####################")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000/api/getUser")]),t._v("\n    location ^~/api/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际指向为：http://127.0.0.1:8000/api/getUser")]),t._v("\n    location ^~/api "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#################### 第二种场景（代理地址+斜杠） ####################")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000/getUser")]),t._v("\n    location ^~/api/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000//getUser")]),t._v("\n    location ^~/api "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#################### 第三种场景（代理地址+后缀） ####################")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000/user/getUser")]),t._v("\n    location ^~/api "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/user;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000/usergetUser")]),t._v("\n    location ^~/api/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/user;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#################### 第四种场景（代理地址+后缀+斜杠） ####################")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000/user/getUser")]),t._v("\n    location ^~/api/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/user/;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求路径为：http://127.0.0.1:8080/api/getUser   实际代理为：http://127.0.0.1:8000/user//getUser")]),t._v("\n    location ^~/api "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_pass http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//127.0.0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/user/;\n      proxy_set_header Host $http_host; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到完整的ip+端口号")]),t._v("\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr; "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台可以获取到用户访问的真实ip地址")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 演示前端项目如何部署nginx")]),t._v("\n  server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen 8090;\n    server_name localhost;\n\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认访问")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署路径：/home/web/my_demo")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问路径为：http://localhost:8090/")]),t._v("\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      try_files $uri $uri/ /index.html;\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr;\n      proxy_set_header Host $http_host;\n      root /home/web/my_demo/;\n      index index.html index.htm;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 带前缀的访问")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署路径：/home/web/my_demo")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问路径为：http://localhost:8090/my_demo/")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果location路径最后没有配置斜杠，则浏览器输入访问地址后，路径最后会自动拼一个斜杠")]),t._v("\n    location ^~/my_demo/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      try_files $uri $uri/ /my_demo/index.html;\n      proxy_set_header X"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Real"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("IP $remote_addr;\n      proxy_set_header Host $http_host;\n      root /home/web/;\n      index index.html index.htm;\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);n.default=e.exports}}]);